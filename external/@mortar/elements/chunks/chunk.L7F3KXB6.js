import {
  MteElement,
  PresetMixinFactory,
  StatusColorMixin,
  __decorateClass,
  computed,
  defineElement,
  isSsr,
  onUpdate,
  signal
} from "./chunk.Y4EV6E5D.js";

// src/atomic/icon/icon-registry.service.ts
import { mtrIconHelpRhombus } from "@mortar/icons";
var _MteIconRegistryService = class {
  constructor() {
    /** Map where loaded icon svgs are cached */
    this.iconRegistry = /* @__PURE__ */ new Map();
    /** Map of registered lazy loading resolver functions per icon library */
    this.iconUrlResolvers = /* @__PURE__ */ new Map();
    /** Defines the svg used when an icon cannot be loaded */
    this.fallbackIcon = mtrIconHelpRhombus?.data;
    /** Tracks if icons should be lazy loaded internally */
    this.lazyLoadEnabled = true;
    /** Prevents logs and fetches when true */
    this.testModeEnabled = false;
    /** Delimiter used when creating library + icon name keys */
    this.delimiter = "~";
    this.iconUrlResolvers.set("_default", (iconName) => {
      return `https://mortar-cdn.heb.com/icons/mdi/7.2/${iconName}.svg`;
    });
    this.iconUrlResolvers.set("cx", (iconName) => {
      return `https://mortar-cdn.heb.com/icons/cx/1.1/${iconName}.svg`;
    });
    this.ssrInit().then(() => {
    });
  }
  /** @hidden */
  async ssrInit() {
    try {
      if (isSsr()) {
        const iconImport = process?.env.MORTAR_DYNAMIC_SSR_ICON_IMPORTS === "true" ? "@mortar/icons" : null;
        if (iconImport) {
          const icons = await import(
            /* webpackIgnore: true */
            /* @vite-ignore */
            iconImport
          );
          this.serverIconCache = icons?.default ?? icons;
        }
      }
    } catch (e) {
    }
  }
  /**
   * Configures the root url from which this service will attempt to fetch icons from for the given "library".
   */
  registerIconLibrary(iconLibrary = "_default", iconUrlResolver) {
    this.lazyLoadEnabled = true;
    if (iconUrlResolver) {
      this.iconUrlResolvers.set(iconLibrary ?? "_default", iconUrlResolver);
    }
    for (const [name, iconSignal] of this.iconRegistry) {
      if (!iconSignal || !iconSignal.get()?.fetched) {
        const [iconLibrary2, pathName] = name.split(this.delimiter);
        this.fetchIcon(pathName, iconLibrary2).then((icon) => {
          iconSignal.set({ fetched: true, data: icon });
        });
      }
    }
  }
  /** Manually registers new icons */
  registerIcons(icons, iconLibrary = "_default") {
    icons.forEach((icon) => {
      const iconSignal = this.iconRegistry.get(`${iconLibrary}${this.delimiter}${icon.name}`);
      if (!iconSignal) {
        this.iconRegistry.set(
          `${iconLibrary}${this.delimiter}${icon.name}`,
          signal({ fetched: true, data: icon.data })
        );
      } else if (iconSignal && !iconSignal.get()?.fetched) {
        iconSignal.set({ fetched: true, data: icon.data });
      }
    });
  }
  /**
   * Allows you to override the lazy loading. Defaults to `true`.
   * When `false` icons will not be fetched from remote locations.
   */
  setLazyLoading(value = true) {
    this.lazyLoadEnabled = value;
  }
  /**
   * Allows you to override the test mode. Defaults to `false`.
   * When true warnings will not be thrown and no fetches will be made.
   */
  setTestMode(value = false) {
    this.testModeEnabled = value;
  }
  /** Sets a new custom fallback icon */
  setFallbackIcon(fallbackIcon) {
    this.fallbackIcon = fallbackIcon;
  }
  /**
   * Attempts to retrieve an icon from the registry.
   *
   * If a rootSvgIconUrl has been set, this method will
   * attempt to load the icon from there. If successful,
   * that svg will be registered for reuse.
   */
  getIcon(pathName, iconLibrary = "_default", abortSignal) {
    if (pathName === void 0) {
      return signal(this.fallbackIcon);
    }
    const registeredSignal = this.iconRegistry.get(`${iconLibrary}${this.delimiter}${pathName}`);
    const iconRegistered = !!registeredSignal;
    if (iconRegistered) {
      return computed(registeredSignal, (entry) => {
        return entry?.data;
      });
    } else if (!iconRegistered && this.lazyLoadEnabled) {
      let iconSignal;
      if (isSsr()) {
        if (this.serverIconCache) {
          const camelName = pathName.replace(/-([a-z])/g, (g) => g[1].toUpperCase());
          const iconName = `${iconLibrary === "cx" ? "cx" : "mtr"}Icon${camelName.charAt(0).toUpperCase()}${camelName.slice(1)}`;
          if (this.serverIconCache[iconName]) {
            iconSignal = signal({
              data: this.serverIconCache[iconName]?.data,
              fetched: true
            });
          } else {
            return this.handledFailedLoad(iconLibrary, pathName, iconSignal);
          }
        } else {
          iconSignal = signal({
            data: null,
            fetched: false
          });
        }
      } else {
        iconSignal = signal({
          data: null,
          fetched: false
        });
        this.iconRegistry.set(`${iconLibrary}${this.delimiter}${pathName}`, iconSignal);
        this.fetchIcon(pathName, iconLibrary, abortSignal).then((icon) => {
          iconSignal.set({ data: icon, fetched: true });
        });
      }
      return computed(iconSignal, (entry) => entry?.data);
    } else if (!iconRegistered && !this.lazyLoadEnabled) {
      const temp = this.handledFailedLoad(iconLibrary, pathName);
      return temp;
    }
  }
  /** Logs a warning and returns fallback icon. Call when attempt to load icon has failed. */
  handledFailedLoad(iconLibrary, pathName, iconSignal) {
    if (!iconSignal) {
      iconSignal = signal({
        data: this.fallbackIcon,
        fetched: false
      });
    }
    this.iconRegistry.set(`${iconLibrary}${this.delimiter}${pathName}`, iconSignal);
    if (!this.testModeEnabled) {
      console.warn(
        `Mortar: No icon is registered for the path name "${pathName}". Did you add it to the mortar icon registry?`
      );
    }
    return computed(iconSignal, (entry) => entry?.data);
  }
  /** Fetches an icon for the given library by name */
  async fetchIcon(pathName, iconLibrary = "_default", abortSignal) {
    if (!this.testModeEnabled) {
      try {
        const resolver = this.iconUrlResolvers.get(iconLibrary);
        if (!resolver) {
          console.warn(
            `MteIconRegistryService: No iconUrlResolver registered for library: "${iconLibrary}"`
          );
          return this.fallbackIcon;
        }
        const req = fetch(resolver(pathName), { method: "get", signal: abortSignal });
        const res = this.parseIconData(pathName, req);
        return await res;
      } catch (e) {
        if (pathName) {
          console.error(`MteIconRegistryService: failed to load icon: ${pathName}`);
        }
        return this.fallbackIcon;
      }
    }
    return this.fallbackIcon;
  }
  /** Asynchronously parse icon fetch response data */
  parseIconData(pathName, req) {
    return new Promise((resolve, reject) => {
      req.then((res) => {
        if (res.status >= 200 && res.status < 300) {
          resolve(res.text());
        } else {
          if (pathName) {
            console.error(`MteIconRegistryService: failed to load icon: ${pathName}`);
          }
          resolve(this.fallbackIcon);
        }
      }).catch((e) => {
        resolve(this.fallbackIcon);
      });
    });
  }
};
var MteIconRegistryService = new _MteIconRegistryService();

// src/atomic/icon/icon.element.ts
import { html } from "lit";
import { property, state } from "lit/decorators.js";

// src/atomic/icon/icon.styles.ts
import { css } from "lit";
var styles = css`:host{box-sizing:content-box!important;color:var(--icon-color,inherit);display:inline-block;line-height:0;width:24px}:host([autosize]){vertical-align:middle}:host([muted]){--icon-color:var(--mte-ink-2)}svg{display:block;height:100%;width:100%}:host(:not([withColor])) svg *{color:inherit;fill:currentColor!important}:host([color=primary])>svg *{color:rgb(var(--mte-status-primary-base-rgb))}:host([color=secondary])>svg *{color:rgb(var(--mte-status-secondary-base-rgb))}:host([color=tertiary])>svg *{color:rgb(var(--mte-status-tertiary-base-rgb))}:host([color=success])>svg *{color:rgb(var(--mte-status-success-base-rgb))}:host([color=warning])>svg *{color:rgb(var(--mte-status-warning-base-rgb))}:host([color=danger])>svg *{color:rgb(var(--mte-status-danger-base-rgb))}`;

// src/atomic/icon/icon.element.ts
import { unsafeSVG } from "lit/directives/unsafe-svg.js";
import { selectorFactory } from "@mortar/styles";
var MteIcon = class extends StatusColorMixin(
  PresetMixinFactory("MteIcon")(MteElement)
) {
  constructor() {
    super(...arguments);
    this.library = "_default";
    this.size = 24;
    this.autosize = false;
    this.role = "img";
    this.ariaHidden = "true";
    this.muted = false;
    this.withColor = false;
  }
  handleNameUpdate() {
    if (this.name) {
      if (this.needsIconUpdate()) {
        this.fetchAbortController?.abort();
        this.fetchAbortController = new AbortController();
        this.previousIconSubscription?.();
        this.previousIconSubscription = MteIconRegistryService.getIcon(
          this.name,
          this.library,
          this.fetchAbortController.signal
        ).subscribe((icon, unsub) => {
          if (icon) {
            const oldSvg = this.iconSvg;
            const oldLoaded = this._loaded;
            if (isSsr()) {
              this.iconSvg = icon;
              this._loaded = `${this.library}~${this.name}`;
              this.requestUpdate("iconSvg", oldSvg);
              this.requestUpdate("_loaded", oldLoaded);
            } else {
              this.updateComplete.then(() => {
                this.iconSvg = icon;
                this._loaded = `${this.library}~${this.name}`;
                this.requestUpdate("iconSvg", oldSvg);
                this.requestUpdate("_loaded", oldLoaded);
              });
            }
            if (this.iconSvg !== null && this.iconSvg !== MteIconRegistryService["fallbackIcon"]) {
              unsub();
              this.previousIconSubscription?.();
              this.previousIconSubscription = null;
            }
          }
          if (isSsr()) {
            unsub();
          }
        });
      } else if (!this.iconSvg) {
        const svg = this.renderRoot?.querySelector("svg")?.outerHTML ?? null;
        this.updateComplete.then(() => {
          this.iconSvg = svg;
          this.requestUpdate("iconSvg", null);
        });
      }
    } else {
      this._loaded = null;
      this.iconSvg = void 0;
    }
  }
  handleAriaLabelChange() {
    if (!this.ariaLabel) {
      this.ariaHidden = "true";
    }
    if (this.ariaLabel && this.ariaHidden === "true") {
      this.ariaHidden = null;
    }
  }
  updateInstanceStyles(changedProps) {
    super.updateInstanceStyles(changedProps);
    if (changedProps.has("size") || changedProps.has("iconSvg") || changedProps.has("autosize")) {
      if (this.autosize || this.size) {
        const size = this.autosize ? "calc(1em + 2px)" : `${this.size}px`;
        this.setInstanceStyle("mte-icon-sizing", selectorFactory(":host:host"), {
          width: size,
          minWidth: size,
          height: size,
          minHeight: size
        });
      }
    }
  }
  disconnectedCallback() {
    super.disconnectedCallback();
    this.previousIconSubscription?.();
  }
  needsIconUpdate() {
    return !this._loaded || this._loaded !== `${this.library}~${this.name}`;
  }
  render() {
    return html`${this.instanceStyles}${unsafeSVG(this.iconSvg)}`;
  }
};
MteIcon.styles = [styles];
__decorateClass([
  property({ reflect: true })
], MteIcon.prototype, "name", 2);
__decorateClass([
  property({ reflect: true })
], MteIcon.prototype, "library", 2);
__decorateClass([
  property({ type: Number, reflect: true })
], MteIcon.prototype, "size", 2);
__decorateClass([
  property({ type: Boolean, reflect: true })
], MteIcon.prototype, "autosize", 2);
__decorateClass([
  property({ reflect: true })
], MteIcon.prototype, "role", 2);
__decorateClass([
  property({ attribute: "aria-label", reflect: true })
], MteIcon.prototype, "ariaLabel", 2);
__decorateClass([
  property({ attribute: "aria-hidden", reflect: true })
], MteIcon.prototype, "ariaHidden", 2);
__decorateClass([
  property({ type: Boolean, reflect: true })
], MteIcon.prototype, "muted", 2);
__decorateClass([
  property({ type: Boolean, reflect: true })
], MteIcon.prototype, "withColor", 2);
__decorateClass([
  property({ reflect: true })
], MteIcon.prototype, "_loaded", 2);
__decorateClass([
  state()
], MteIcon.prototype, "iconSvg", 2);
__decorateClass([
  onUpdate(["name", "library"], { on: "both" })
], MteIcon.prototype, "handleNameUpdate", 1);
__decorateClass([
  onUpdate(["ariaLabel"], { on: "both" })
], MteIcon.prototype, "handleAriaLabelChange", 1);
MteIcon = __decorateClass([
  defineElement("mte-icon")
], MteIcon);

export {
  _MteIconRegistryService,
  MteIconRegistryService,
  MteIcon
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vc3JjL2F0b21pYy9pY29uL2ljb24tcmVnaXN0cnkuc2VydmljZS50cyIsICIuLi8uLi8uLi9zcmMvYXRvbWljL2ljb24vaWNvbi5lbGVtZW50LnRzIiwgIi4uLy4uLy4uL3NyYy9hdG9taWMvaWNvbi9pY29uLnN0eWxlcy50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWluZmVycmFibGUtdHlwZXMgKi9cbmltcG9ydCB7IFNpZ25hbCwgc2lnbmFsLCBpc1NzciwgY29tcHV0ZWQgfSBmcm9tICcuLi8uLi9jb3JlJztcbmltcG9ydCB7IE1vcnRhckljb24sIG10ckljb25IZWxwUmhvbWJ1cyB9IGZyb20gJ0Btb3J0YXIvaWNvbnMnO1xuXG5leHBvcnQgdHlwZSBJY29uRGF0YSA9IHsgZGF0YT86IHN0cmluZzsgZmV0Y2hlZD86IGJvb2xlYW4gfTtcblxuLyoqXG4gKiBTZXJ2aWNlIHVzZWQgdG8gcmVnaXN0ZXIgc3ZnIHN0cmluZ3MgZm9yIGEgZ2l2ZW4gaWNvbiBuYW1lIGFuZCB0aGVuIGxvb2sgdGhlbVxuICogdXAgYnkgdGhhdCBzYW1lIG5hbWUgb3IgZmV0Y2ggdGhlbSBmcm9tIGEgQ0ROLiBUaGUgYE10ZUljb25SZWdpc3RyeVNlcnZpY2VgIGlzXG4gKiBhIHNpbmdsZXRvbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLiBZb3Ugc2hvdWxkIGFsd2F5cyB1c2UgdGhhdCBleHBvcnQgaW5zdGVhZFxuICogb2YgaW5pdGlhbGl6aW5nIGEgbmV3IGluc3RhbmNlLlxuICovXG5leHBvcnQgY2xhc3MgX010ZUljb25SZWdpc3RyeVNlcnZpY2Uge1xuICAvKiogTWFwIHdoZXJlIGxvYWRlZCBpY29uIHN2Z3MgYXJlIGNhY2hlZCAqL1xuICBwcml2YXRlIGljb25SZWdpc3RyeSA9IG5ldyBNYXA8c3RyaW5nLCBTaWduYWw8SWNvbkRhdGE+PigpO1xuXG4gIC8qKiBNYXAgb2YgcmVnaXN0ZXJlZCBsYXp5IGxvYWRpbmcgcmVzb2x2ZXIgZnVuY3Rpb25zIHBlciBpY29uIGxpYnJhcnkgKi9cbiAgcHJpdmF0ZSBpY29uVXJsUmVzb2x2ZXJzID0gbmV3IE1hcDxzdHJpbmcsIChpY29uTmFtZTogc3RyaW5nKSA9PiBzdHJpbmc+KCk7XG5cbiAgLyoqIERlZmluZXMgdGhlIHN2ZyB1c2VkIHdoZW4gYW4gaWNvbiBjYW5ub3QgYmUgbG9hZGVkICovXG4gIHByaXZhdGUgZmFsbGJhY2tJY29uID0gbXRySWNvbkhlbHBSaG9tYnVzPy5kYXRhO1xuXG4gIC8qKiBUcmFja3MgaWYgaWNvbnMgc2hvdWxkIGJlIGxhenkgbG9hZGVkIGludGVybmFsbHkgKi9cbiAgcHJpdmF0ZSBsYXp5TG9hZEVuYWJsZWQgPSB0cnVlO1xuXG4gIC8qKiBQcmV2ZW50cyBsb2dzIGFuZCBmZXRjaGVzIHdoZW4gdHJ1ZSAqL1xuICBwcml2YXRlIHRlc3RNb2RlRW5hYmxlZCA9IGZhbHNlO1xuXG4gIC8qKiBEZWxpbWl0ZXIgdXNlZCB3aGVuIGNyZWF0aW5nIGxpYnJhcnkgKyBpY29uIG5hbWUga2V5cyAqL1xuICBwcml2YXRlIGRlbGltaXRlciA9ICd+JztcblxuICAvKiogSWYgZXhlY3V0aW5nIHNlcnZlci1zaWRlIGFsbCBtb3J0YXIgaWNvbnMgd2lsbCBiZSBsb2FkZWQgaGVyZSAqL1xuICBwcml2YXRlIHNlcnZlckljb25DYWNoZT86IFJlY29yZDxzdHJpbmcsIE1vcnRhckljb24+O1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuaWNvblVybFJlc29sdmVycy5zZXQoJ19kZWZhdWx0JywgKGljb25OYW1lOiBzdHJpbmcpID0+IHtcbiAgICAgIHJldHVybiBgaHR0cHM6Ly9tb3J0YXItY2RuLmhlYi5jb20vaWNvbnMvbWRpLzcuMi8ke2ljb25OYW1lfS5zdmdgO1xuICAgIH0pO1xuICAgIHRoaXMuaWNvblVybFJlc29sdmVycy5zZXQoJ2N4JywgKGljb25OYW1lOiBzdHJpbmcpID0+IHtcbiAgICAgIHJldHVybiBgaHR0cHM6Ly9tb3J0YXItY2RuLmhlYi5jb20vaWNvbnMvY3gvMS4xLyR7aWNvbk5hbWV9LnN2Z2A7XG4gICAgfSk7XG4gICAgdGhpcy5zc3JJbml0KCkudGhlbigoKSA9PiB7fSk7XG4gIH1cblxuICAvKiogQGhpZGRlbiAqL1xuICBhc3luYyBzc3JJbml0KCkge1xuICAgIC8qKlxuICAgICAqIFRoaXMgbW9uc3Ryb3NpdHkgZW5hYmxlcyBsb2NhbCBpY29uIHJlbmRlcmluZyBkdXJpbmcgU1NSIF9XSVRIT1VUXyBhbHNvIHJlc3VsdGluZyBpblxuICAgICAqIGJ1bmRsZXJzIHB1bGxpbmcgaW4gdGhlIGVudGlyZSBpY29uIGxpYnJhcnkgZWxzZXdoZXJlLiBUaGlzIGNhbiBhbHNvIGJlIGFjaGlldmVkIHdpdGgganVzdFxuICAgICAqIHRoZSBtYWdpYyBjb21tZW50cyBiZWxvdy4uLmJ1dCBub3QgYWxsIGJ1bmRsZXJzIHN1cHBvcnQgdGhhdCBraW5kIG9mIGZlYXR1cmUgc28gdGhpcyBpcyBhblxuICAgICAqIGV4dHJhIHByZWNhdXRpb24uXG4gICAgICpcbiAgICAgKiBGb3IgdGhpcyB0byB3b3JrOlxuICAgICAqIC0gVGhlIGVudmlyb25tZW50IHZhcmlhYmxlIGBNT1JUQVJfRFlOQU1JQ19TU1JfSUNPTl9JTVBPUlRTYCBtdXN0IGJlIHRydWVcbiAgICAgKiAtIFRoZSBgQG1vcnRhci9pY29uc2AgcGFja2FnZSBtdXN0IGJlIGF2YWlsYWJsZVxuICAgICAqL1xuICAgIHRyeSB7XG4gICAgICBpZiAoaXNTc3IoKSkge1xuICAgICAgICBjb25zdCBpY29uSW1wb3J0ID1cbiAgICAgICAgICAocHJvY2VzcyBhcyBhbnkpPy5lbnYuTU9SVEFSX0RZTkFNSUNfU1NSX0lDT05fSU1QT1JUUyA9PT0gJ3RydWUnID8gJ0Btb3J0YXIvaWNvbnMnIDogbnVsbDtcbiAgICAgICAgaWYgKGljb25JbXBvcnQpIHtcbiAgICAgICAgICAvLyBBdHRlbXB0IHRvIGxvYWQgYWxsIGljb25zIGxvY2FsbHkgaWYgcnVuIHNlcnZlciBzaWRlLiBUaGUgaWdub3JlXG4gICAgICAgICAgLy8gY29tbWVudHMgaGVyZSBwcmV2ZW50IHdlYnBhY2sgJiB2aXRlIGZyb20gdGhyb3dpbmcgYSB3YXJuaW5nXG4gICAgICAgICAgLy8gc2luY2UgdGhlaXIgaW5hYmlsaXR5IHRvIG9wdGltaXplIHRoaXMgaXMgaW50ZW50aW9uYWwgaGVyZS5cbiAgICAgICAgICBjb25zdCBpY29ucyA9IGF3YWl0IGltcG9ydCgvKiB3ZWJwYWNrSWdub3JlOiB0cnVlICovIC8qIEB2aXRlLWlnbm9yZSAqLyBpY29uSW1wb3J0KTtcbiAgICAgICAgICB0aGlzLnNlcnZlckljb25DYWNoZSA9IGljb25zPy5kZWZhdWx0ID8/IGljb25zO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgLyogZW1wdHkgKi9cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ29uZmlndXJlcyB0aGUgcm9vdCB1cmwgZnJvbSB3aGljaCB0aGlzIHNlcnZpY2Ugd2lsbCBhdHRlbXB0IHRvIGZldGNoIGljb25zIGZyb20gZm9yIHRoZSBnaXZlbiBcImxpYnJhcnlcIi5cbiAgICovXG4gIHB1YmxpYyByZWdpc3Rlckljb25MaWJyYXJ5KFxuICAgIGljb25MaWJyYXJ5ID0gJ19kZWZhdWx0JyxcbiAgICBpY29uVXJsUmVzb2x2ZXI/OiAoaWNvbk5hbWU6IHN0cmluZykgPT4gc3RyaW5nXG4gICkge1xuICAgIHRoaXMubGF6eUxvYWRFbmFibGVkID0gdHJ1ZTtcbiAgICBpZiAoaWNvblVybFJlc29sdmVyKSB7XG4gICAgICB0aGlzLmljb25VcmxSZXNvbHZlcnMuc2V0KGljb25MaWJyYXJ5ID8/ICdfZGVmYXVsdCcsIGljb25VcmxSZXNvbHZlcik7XG4gICAgfVxuXG4gICAgLy8gRmV0Y2ggYW55IGljb25zIHJlcXVlc3RlZCBiZWZvcmUgdGhpcyB3YXMgY2FsbGVkIHRoYXQgaGF2ZSBub3QgeWV0IGJlZW4gZmV0Y2hlZFxuICAgIGZvciAoY29uc3QgW25hbWUsIGljb25TaWduYWxdIG9mIHRoaXMuaWNvblJlZ2lzdHJ5KSB7XG4gICAgICBpZiAoIWljb25TaWduYWwgfHwgIWljb25TaWduYWwuZ2V0KCk/LmZldGNoZWQpIHtcbiAgICAgICAgY29uc3QgW2ljb25MaWJyYXJ5LCBwYXRoTmFtZV0gPSBuYW1lLnNwbGl0KHRoaXMuZGVsaW1pdGVyKTtcbiAgICAgICAgdGhpcy5mZXRjaEljb24ocGF0aE5hbWUsIGljb25MaWJyYXJ5KS50aGVuKChpY29uKSA9PiB7XG4gICAgICAgICAgaWNvblNpZ25hbC5zZXQoeyBmZXRjaGVkOiB0cnVlLCBkYXRhOiBpY29uIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKiogTWFudWFsbHkgcmVnaXN0ZXJzIG5ldyBpY29ucyAqL1xuICBwdWJsaWMgcmVnaXN0ZXJJY29ucyhpY29uczogTW9ydGFySWNvbltdLCBpY29uTGlicmFyeSA9ICdfZGVmYXVsdCcpIHtcbiAgICBpY29ucy5mb3JFYWNoKChpY29uKSA9PiB7XG4gICAgICBjb25zdCBpY29uU2lnbmFsID0gdGhpcy5pY29uUmVnaXN0cnkuZ2V0KGAke2ljb25MaWJyYXJ5fSR7dGhpcy5kZWxpbWl0ZXJ9JHtpY29uLm5hbWV9YCk7XG4gICAgICBpZiAoIWljb25TaWduYWwpIHtcbiAgICAgICAgdGhpcy5pY29uUmVnaXN0cnkuc2V0KFxuICAgICAgICAgIGAke2ljb25MaWJyYXJ5fSR7dGhpcy5kZWxpbWl0ZXJ9JHtpY29uLm5hbWV9YCxcbiAgICAgICAgICBzaWduYWwoeyBmZXRjaGVkOiB0cnVlLCBkYXRhOiBpY29uLmRhdGEgfSlcbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSBpZiAoaWNvblNpZ25hbCAmJiAhaWNvblNpZ25hbC5nZXQoKT8uZmV0Y2hlZCkge1xuICAgICAgICBpY29uU2lnbmFsLnNldCh7IGZldGNoZWQ6IHRydWUsIGRhdGE6IGljb24uZGF0YSB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBbGxvd3MgeW91IHRvIG92ZXJyaWRlIHRoZSBsYXp5IGxvYWRpbmcuIERlZmF1bHRzIHRvIGB0cnVlYC5cbiAgICogV2hlbiBgZmFsc2VgIGljb25zIHdpbGwgbm90IGJlIGZldGNoZWQgZnJvbSByZW1vdGUgbG9jYXRpb25zLlxuICAgKi9cbiAgcHVibGljIHNldExhenlMb2FkaW5nKHZhbHVlOiBib29sZWFuID0gdHJ1ZSkge1xuICAgIHRoaXMubGF6eUxvYWRFbmFibGVkID0gdmFsdWU7XG4gIH1cblxuICAvKipcbiAgICogQWxsb3dzIHlvdSB0byBvdmVycmlkZSB0aGUgdGVzdCBtb2RlLiBEZWZhdWx0cyB0byBgZmFsc2VgLlxuICAgKiBXaGVuIHRydWUgd2FybmluZ3Mgd2lsbCBub3QgYmUgdGhyb3duIGFuZCBubyBmZXRjaGVzIHdpbGwgYmUgbWFkZS5cbiAgICovXG4gIHB1YmxpYyBzZXRUZXN0TW9kZSh2YWx1ZTogYm9vbGVhbiA9IGZhbHNlKSB7XG4gICAgdGhpcy50ZXN0TW9kZUVuYWJsZWQgPSB2YWx1ZTtcbiAgfVxuXG4gIC8qKiBTZXRzIGEgbmV3IGN1c3RvbSBmYWxsYmFjayBpY29uICovXG4gIHB1YmxpYyBzZXRGYWxsYmFja0ljb24oZmFsbGJhY2tJY29uOiBzdHJpbmcgfCBudWxsKSB7XG4gICAgdGhpcy5mYWxsYmFja0ljb24gPSBmYWxsYmFja0ljb247XG4gIH1cblxuICAvKipcbiAgICogQXR0ZW1wdHMgdG8gcmV0cmlldmUgYW4gaWNvbiBmcm9tIHRoZSByZWdpc3RyeS5cbiAgICpcbiAgICogSWYgYSByb290U3ZnSWNvblVybCBoYXMgYmVlbiBzZXQsIHRoaXMgbWV0aG9kIHdpbGxcbiAgICogYXR0ZW1wdCB0byBsb2FkIHRoZSBpY29uIGZyb20gdGhlcmUuIElmIHN1Y2Nlc3NmdWwsXG4gICAqIHRoYXQgc3ZnIHdpbGwgYmUgcmVnaXN0ZXJlZCBmb3IgcmV1c2UuXG4gICAqL1xuICBwdWJsaWMgZ2V0SWNvbihcbiAgICBwYXRoTmFtZTogc3RyaW5nLFxuICAgIGljb25MaWJyYXJ5ID0gJ19kZWZhdWx0JyxcbiAgICBhYm9ydFNpZ25hbD86IEFib3J0U2lnbmFsXG4gICk6IFNpZ25hbDxzdHJpbmcgfCBudWxsPiB7XG4gICAgLy8gSWYgaWNvbiBpcyB1bmRlZmluZWQgaW5zdGFudGx5IHJldHVybiB0aGUgZmFsbGJhY2sgaWNvblxuICAgIGlmIChwYXRoTmFtZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gc2lnbmFsKHRoaXMuZmFsbGJhY2tJY29uKTtcbiAgICB9XG4gICAgY29uc3QgcmVnaXN0ZXJlZFNpZ25hbCA9IHRoaXMuaWNvblJlZ2lzdHJ5LmdldChgJHtpY29uTGlicmFyeX0ke3RoaXMuZGVsaW1pdGVyfSR7cGF0aE5hbWV9YCk7XG4gICAgY29uc3QgaWNvblJlZ2lzdGVyZWQgPSAhIXJlZ2lzdGVyZWRTaWduYWw7XG4gICAgLy8gSWYgdGhlIGljb24gaXMgcmVnaXN0ZXJlZCBqdXN0IHJldHVybiBpdFxuICAgIGlmIChpY29uUmVnaXN0ZXJlZCkge1xuICAgICAgcmV0dXJuIGNvbXB1dGVkKHJlZ2lzdGVyZWRTaWduYWwsIChlbnRyeSkgPT4ge1xuICAgICAgICByZXR1cm4gZW50cnk/LmRhdGE7XG4gICAgICB9KTtcbiAgICB9XG4gICAgLy8gT3RoZXJ3aXNlLCBpZiBsYXp5TG9hZEVuYWJsZWQgdGhlbiBhdHRlbXB0IHRvIGZldGNoIGFuZCByZWdpc3RlciB0aGUgaWNvblxuICAgIGVsc2UgaWYgKCFpY29uUmVnaXN0ZXJlZCAmJiB0aGlzLmxhenlMb2FkRW5hYmxlZCkge1xuICAgICAgbGV0IGljb25TaWduYWw6IFNpZ25hbDxJY29uRGF0YT47XG5cbiAgICAgIC8vIExvYWQgZnJvbSBsb2NhbCBzZXJ2ZXIgaWNvbiBjYWNoZSBkdXJpbmcgc3NyIGlmIGl0IGV4aXN0c1xuICAgICAgaWYgKGlzU3NyKCkpIHtcbiAgICAgICAgaWYgKHRoaXMuc2VydmVySWNvbkNhY2hlKSB7XG4gICAgICAgICAgY29uc3QgY2FtZWxOYW1lID0gcGF0aE5hbWUucmVwbGFjZSgvLShbYS16XSkvZywgKGcpID0+IGdbMV0udG9VcHBlckNhc2UoKSk7XG4gICAgICAgICAgY29uc3QgaWNvbk5hbWUgPSBgJHtpY29uTGlicmFyeSA9PT0gJ2N4JyA/ICdjeCcgOiAnbXRyJ31JY29uJHtjYW1lbE5hbWVcbiAgICAgICAgICAgIC5jaGFyQXQoMClcbiAgICAgICAgICAgIC50b1VwcGVyQ2FzZSgpfSR7Y2FtZWxOYW1lLnNsaWNlKDEpfWA7XG5cbiAgICAgICAgICBpZiAodGhpcy5zZXJ2ZXJJY29uQ2FjaGVbaWNvbk5hbWVdIGFzIGFueSkge1xuICAgICAgICAgICAgaWNvblNpZ25hbCA9IHNpZ25hbDxJY29uRGF0YT4oe1xuICAgICAgICAgICAgICBkYXRhOiAodGhpcy5zZXJ2ZXJJY29uQ2FjaGVbaWNvbk5hbWVdIGFzIGFueSk/LmRhdGEsXG4gICAgICAgICAgICAgIGZldGNoZWQ6IHRydWUsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlZEZhaWxlZExvYWQoaWNvbkxpYnJhcnksIHBhdGhOYW1lLCBpY29uU2lnbmFsKSBhcyBTaWduYWw8XG4gICAgICAgICAgICAgIHN0cmluZyB8IG51bGxcbiAgICAgICAgICAgID47XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIElmIHRoZSBpY29uIGNhY2hlIGRvZXNuJ3QgZXhpc3QganVzdCBkbyBub3RoaW5nIGJlY2F1c2UgdGhlIGljb24gd2lsbCBiZSBsb2FkZWQgb24gdGhlIGNsaWVudFxuICAgICAgICAgIGljb25TaWduYWwgPSBzaWduYWw8SWNvbkRhdGE+KHtcbiAgICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgICBmZXRjaGVkOiBmYWxzZSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLy8gSWYgbm90IG9uIHRoZSBzZXJ2ZXIgdGhlbiBmZXRjaCB0aGUgaWNvblxuICAgICAgZWxzZSB7XG4gICAgICAgIC8vIFNldCB0aGUgaWNvbiBhcyB0aGUgcmVzdWx0IG9mIHRoZSBhd2FpdCByaWdodCBub3csIGJlZm9yZSB0aGUgZmV0Y2hcbiAgICAgICAgLy8gaXMgaW5pdGlhdGVkLCB0byBwcmV2ZW50IHJlZHVuZGFudCBpbml0aWFsIHF1ZXJpZXMgb24gcGFnZSBsb2FkXG4gICAgICAgIGljb25TaWduYWwgPSBzaWduYWw8SWNvbkRhdGE+KHtcbiAgICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICAgIGZldGNoZWQ6IGZhbHNlLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5pY29uUmVnaXN0cnkuc2V0KGAke2ljb25MaWJyYXJ5fSR7dGhpcy5kZWxpbWl0ZXJ9JHtwYXRoTmFtZX1gLCBpY29uU2lnbmFsKTtcblxuICAgICAgICB0aGlzLmZldGNoSWNvbihwYXRoTmFtZSwgaWNvbkxpYnJhcnksIGFib3J0U2lnbmFsKS50aGVuKChpY29uKSA9PiB7XG4gICAgICAgICAgaWNvblNpZ25hbC5zZXQoeyBkYXRhOiBpY29uLCBmZXRjaGVkOiB0cnVlIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGNvbXB1dGVkKGljb25TaWduYWwsIChlbnRyeSkgPT4gZW50cnk/LmRhdGEpO1xuICAgIH1cbiAgICAvLyBPdGhlcndpc2UsIGp1c3QgYWxlcnQgdGhhdCB0aGUgaWNvbiBpc24ndCByZWdpc3RlcmVkIGFuZCByZXR1cm4gdGhlIGZhbGxiYWNrXG4gICAgZWxzZSBpZiAoIWljb25SZWdpc3RlcmVkICYmICF0aGlzLmxhenlMb2FkRW5hYmxlZCkge1xuICAgICAgY29uc3QgdGVtcCA9IHRoaXMuaGFuZGxlZEZhaWxlZExvYWQoaWNvbkxpYnJhcnksIHBhdGhOYW1lKTtcbiAgICAgIHJldHVybiB0ZW1wO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBMb2dzIGEgd2FybmluZyBhbmQgcmV0dXJucyBmYWxsYmFjayBpY29uLiBDYWxsIHdoZW4gYXR0ZW1wdCB0byBsb2FkIGljb24gaGFzIGZhaWxlZC4gKi9cbiAgcHJpdmF0ZSBoYW5kbGVkRmFpbGVkTG9hZChpY29uTGlicmFyeSwgcGF0aE5hbWUsIGljb25TaWduYWw/OiBTaWduYWw8SWNvbkRhdGE+KSB7XG4gICAgLy8gQ3JlYXRlIHJldHVybiBzdWJqIGlmIG9uZSBpc24ndCBwYXNzZWRcbiAgICBpZiAoIWljb25TaWduYWwpIHtcbiAgICAgIGljb25TaWduYWwgPSBzaWduYWw8SWNvbkRhdGE+KHtcbiAgICAgICAgZGF0YTogdGhpcy5mYWxsYmFja0ljb24sXG4gICAgICAgIGZldGNoZWQ6IGZhbHNlLFxuICAgICAgfSk7XG4gICAgfVxuICAgIHRoaXMuaWNvblJlZ2lzdHJ5LnNldChgJHtpY29uTGlicmFyeX0ke3RoaXMuZGVsaW1pdGVyfSR7cGF0aE5hbWV9YCwgaWNvblNpZ25hbCk7XG4gICAgaWYgKCF0aGlzLnRlc3RNb2RlRW5hYmxlZCkge1xuICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICBgTW9ydGFyOiBObyBpY29uIGlzIHJlZ2lzdGVyZWQgZm9yIHRoZSBwYXRoIG5hbWUgXCIke3BhdGhOYW1lfVwiLiBEaWQgeW91IGFkZCBpdCB0byB0aGUgbW9ydGFyIGljb24gcmVnaXN0cnk/YFxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbXB1dGVkKGljb25TaWduYWwsIChlbnRyeSkgPT4gZW50cnk/LmRhdGEpO1xuICB9XG5cbiAgLyoqIEZldGNoZXMgYW4gaWNvbiBmb3IgdGhlIGdpdmVuIGxpYnJhcnkgYnkgbmFtZSAqL1xuICBwcml2YXRlIGFzeW5jIGZldGNoSWNvbihwYXRoTmFtZTogc3RyaW5nLCBpY29uTGlicmFyeSA9ICdfZGVmYXVsdCcsIGFib3J0U2lnbmFsPzogQWJvcnRTaWduYWwpIHtcbiAgICBpZiAoIXRoaXMudGVzdE1vZGVFbmFibGVkKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNvbHZlciA9IHRoaXMuaWNvblVybFJlc29sdmVycy5nZXQoaWNvbkxpYnJhcnkpO1xuICAgICAgICAvLyBJZiBubyByZXNvbHZlciBpcyByZWdpc3RlcmVkIGZvciB0aGUgcmVxdWVzdGVkIGxpYnJhcnlcbiAgICAgICAgaWYgKCFyZXNvbHZlcikge1xuICAgICAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgICAgIGBNdGVJY29uUmVnaXN0cnlTZXJ2aWNlOiBObyBpY29uVXJsUmVzb2x2ZXIgcmVnaXN0ZXJlZCBmb3IgbGlicmFyeTogXCIke2ljb25MaWJyYXJ5fVwiYFxuICAgICAgICAgICk7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuZmFsbGJhY2tJY29uO1xuICAgICAgICB9XG4gICAgICAgIC8vIENyZWF0ZSB0aGUgZmV0Y2ggcmVxdWVzdCBidXQgdG8gbm90IGF3YWl0IHlldFxuICAgICAgICBjb25zdCByZXEgPSBmZXRjaChyZXNvbHZlcihwYXRoTmFtZSksIHsgbWV0aG9kOiAnZ2V0Jywgc2lnbmFsOiBhYm9ydFNpZ25hbCB9KTtcbiAgICAgICAgY29uc3QgcmVzID0gdGhpcy5wYXJzZUljb25EYXRhKHBhdGhOYW1lLCByZXEpO1xuICAgICAgICByZXR1cm4gYXdhaXQgcmVzO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyBJZiB0aGUgZmV0Y2ggZmFpbGVkIGxvZyBhbmQgcmV0dXJuIGZhbGxiYWNrXG4gICAgICAgIGlmIChwYXRoTmFtZSkge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYE10ZUljb25SZWdpc3RyeVNlcnZpY2U6IGZhaWxlZCB0byBsb2FkIGljb246ICR7cGF0aE5hbWV9YCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuZmFsbGJhY2tJY29uO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy5mYWxsYmFja0ljb247XG4gIH1cblxuICAvKiogQXN5bmNocm9ub3VzbHkgcGFyc2UgaWNvbiBmZXRjaCByZXNwb25zZSBkYXRhICovXG4gIHByaXZhdGUgcGFyc2VJY29uRGF0YShwYXRoTmFtZTogc3RyaW5nLCByZXE6IFByb21pc2U8UmVzcG9uc2U+KTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgcmVxXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICBpZiAocmVzLnN0YXR1cyA+PSAyMDAgJiYgcmVzLnN0YXR1cyA8IDMwMCkge1xuICAgICAgICAgICAgcmVzb2x2ZShyZXMudGV4dCgpKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHBhdGhOYW1lKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYE10ZUljb25SZWdpc3RyeVNlcnZpY2U6IGZhaWxlZCB0byBsb2FkIGljb246ICR7cGF0aE5hbWV9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBHcmFjZWZ1bGx5IHJlc29sdmUgd2l0aCBmYWxsYmFjayBpY29uIG9uIGZhaWxlZCBsb2FkXG4gICAgICAgICAgICByZXNvbHZlKHRoaXMuZmFsbGJhY2tJY29uKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZSkgPT4ge1xuICAgICAgICAgIC8vIEdyYWNlZnVsbHkgcmVzb2x2ZSB3aXRoIGZhbGxiYWNrIGljb24gb24gZXJyb3JcbiAgICAgICAgICByZXNvbHZlKHRoaXMuZmFsbGJhY2tJY29uKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn1cblxuY29uc3QgTXRlSWNvblJlZ2lzdHJ5U2VydmljZSA9IG5ldyBfTXRlSWNvblJlZ2lzdHJ5U2VydmljZSgpO1xuXG4vKipcbiAqIEluc3RhbmNlIG9mIF9NdGVJY29uUmVnaXN0cnlTZXJ2aWNlIGV4cG9ydGVkIGFzIGEgc2luZ2xldG9uLlxuICpcbiAqIFNlcnZpY2UgdXNlZCB0byByZWdpc3RlciBzdmcgc3RyaW5ncyBmb3IgYSBnaXZlbiBpY29uIG5hbWUgYW5kIHRoZW4gbG9vayB0aGVtIHVwIGJ5IHRoYXQgc2FtZSBuYW1lLlxuICovXG5leHBvcnQgeyBNdGVJY29uUmVnaXN0cnlTZXJ2aWNlIH07XG4iLCAiaW1wb3J0IHsgaHRtbCB9IGZyb20gJ2xpdCc7XG5pbXBvcnQgeyBwcm9wZXJ0eSwgc3RhdGUgfSBmcm9tICdsaXQvZGVjb3JhdG9ycy5qcyc7XG5pbXBvcnQgeyBzdHlsZXMgfSBmcm9tICcuL2ljb24uc3R5bGVzJztcbmltcG9ydCB7XG4gIGRlZmluZUVsZW1lbnQsXG4gIFN0YXR1c0NvbG9yTWl4aW4sXG4gIE10ZUVsZW1lbnQsXG4gIFByZXNldE1peGluRmFjdG9yeSxcbiAgb25VcGRhdGUsXG4gIFVuc3Vic2NyaWJlcixcbiAgaXNTc3IsXG59IGZyb20gJy4uLy4uL2NvcmUnO1xuaW1wb3J0IHsgbXRySWNvbiB9IGZyb20gJ0Btb3J0YXIvaWNvbnMnO1xuaW1wb3J0IHsgTXRlSWNvblJlZ2lzdHJ5U2VydmljZSB9IGZyb20gJy4vaWNvbi1yZWdpc3RyeS5zZXJ2aWNlJztcbmltcG9ydCB7IEljb25QcmVzZXQgfSBmcm9tICcuL2ljb24ucHJlc2V0cyc7XG5pbXBvcnQgeyB1bnNhZmVTVkcgfSBmcm9tICdsaXQvZGlyZWN0aXZlcy91bnNhZmUtc3ZnLmpzJztcbmltcG9ydCB7IHNlbGVjdG9yRmFjdG9yeSB9IGZyb20gJ0Btb3J0YXIvc3R5bGVzJztcblxuLyoqXG4gKi9cbkBkZWZpbmVFbGVtZW50KCdtdGUtaWNvbicpXG5leHBvcnQgY2xhc3MgTXRlSWNvbiBleHRlbmRzIFN0YXR1c0NvbG9yTWl4aW4oXG4gIFByZXNldE1peGluRmFjdG9yeTxJY29uUHJlc2V0PignTXRlSWNvbicpKE10ZUVsZW1lbnQpXG4pIHtcbiAgc3RhdGljIHN0eWxlcyA9IFtzdHlsZXNdO1xuXG4gIC8qKiBUaGUgbmFtZSBvZiB0aGUgaWNvbiB0byByZW5kZXIgKi9cbiAgQHByb3BlcnR5KHsgcmVmbGVjdDogdHJ1ZSB9KSBuYW1lOiBtdHJJY29uIHwgc3RyaW5nO1xuXG4gIC8qKiBUaGUgbGlicmFyeSB0byBsb2FkIHRoZSBpY29uIGZyb20uIFRoZSBkZWZhdWx0IGxpYnJhcnkgaXMgYF9kZWZhdWx0YC4gKi9cbiAgQHByb3BlcnR5KHsgcmVmbGVjdDogdHJ1ZSB9KSBsaWJyYXJ5ID0gJ19kZWZhdWx0JztcblxuICAvKiogVGhlIHNpemUgb2YgdGhpcyBpY29uLiBNYXRjaGVzIGEgZ2l2ZW4gZm9udC1zaXplIGluIHB4LiAqL1xuICBAcHJvcGVydHkoeyB0eXBlOiBOdW1iZXIsIHJlZmxlY3Q6IHRydWUgfSkgc2l6ZTogc3RyaW5nIHwgbnVtYmVyID0gMjQ7XG5cbiAgLyoqIFNjYWxlIHRoaXMgaWNvbiByZWxhdGl2ZSB0byB0aGUgY29tcHV0ZWQgZm9udC1zaXplIG9mIHRoaXMgZWxlbWVudC4gKi9cbiAgQHByb3BlcnR5KHsgdHlwZTogQm9vbGVhbiwgcmVmbGVjdDogdHJ1ZSB9KSBhdXRvc2l6ZSA9IGZhbHNlO1xuXG4gIC8qKiBBbiBpY29uJ3Mgcm9sZSBpcyBkZWZhdWx0cyB0byBgaW1nYCB0byBlbnN1cmUgdGhleSBkbyBub3QgaW50ZXJydXB0IHRleHQuICAqL1xuICBAcHJvcGVydHkoeyByZWZsZWN0OiB0cnVlIH0pIHJvbGUgPSAnaW1nJztcblxuICAvKiogTGFiZWwgZm9yIGljb24gdG8gYmUgcmVhZCB0byBzY3JlZW5yZWFkZXIgdGVjaG5vbG9naWVzICovXG4gIEBwcm9wZXJ0eSh7IGF0dHJpYnV0ZTogJ2FyaWEtbGFiZWwnLCByZWZsZWN0OiB0cnVlIH0pIGFyaWFMYWJlbDogc3RyaW5nO1xuXG4gIC8qKiBMYWJlbCBmb3IgaWNvbiB0byBiZSByZWFkIHRvIHNjcmVlbnJlYWRlciB0ZWNobm9sb2dpZXMgKi9cbiAgQHByb3BlcnR5KHsgYXR0cmlidXRlOiAnYXJpYS1oaWRkZW4nLCByZWZsZWN0OiB0cnVlIH0pIGFyaWFIaWRkZW4gPSAndHJ1ZSc7XG5cbiAgLyoqIFJlbmRlcnMgdGhlIGljb24gaW4gdGhlIGRlZmF1bHQgbXV0ZWQgaW5rIGNvbG9yLiAqL1xuICBAcHJvcGVydHkoeyB0eXBlOiBCb29sZWFuLCByZWZsZWN0OiB0cnVlIH0pIG11dGVkID0gZmFsc2U7XG5cbiAgLyoqIFJlbmRlcnMgdGhpcyBpY29uIHdpdGggY29sb3JzIGRlZmluZWQgaW4gdGhlIFNWRyBpbnN0ZWFkIG9mIGluaGVyaXRpbmcgZnJvbSBDU1MgcGFyZW50cyAqL1xuICBAcHJvcGVydHkoeyB0eXBlOiBCb29sZWFuLCByZWZsZWN0OiB0cnVlIH0pIHdpdGhDb2xvciA9IGZhbHNlO1xuXG4gIC8qKlxuICAgKiBAaGlkZGVuXG4gICAqIFRyYWNrcyB0aGUgbG9hZGVkIGljb24gc28gd2UgZG9uJ3QgbmVlZCB0byByZWZldGNoIGl0IGR1cmluZyBoeWRyYXRpb25cbiAgICovXG4gIEBwcm9wZXJ0eSh7IHJlZmxlY3Q6IHRydWUgfSkgX2xvYWRlZD86IHN0cmluZztcblxuICBAc3RhdGUoKSBwcml2YXRlIGljb25Tdmc6IHN0cmluZztcblxuICBwcml2YXRlIGZldGNoQWJvcnRDb250cm9sbGVyPzogQWJvcnRDb250cm9sbGVyO1xuXG4gIHByaXZhdGUgcHJldmlvdXNJY29uU3Vic2NyaXB0aW9uOiBVbnN1YnNjcmliZXI7XG5cbiAgQG9uVXBkYXRlKFsnbmFtZScsICdsaWJyYXJ5J10sIHsgb246ICdib3RoJyB9KVxuICBwcml2YXRlIGhhbmRsZU5hbWVVcGRhdGUoKSB7XG4gICAgaWYgKHRoaXMubmFtZSkge1xuICAgICAgaWYgKHRoaXMubmVlZHNJY29uVXBkYXRlKCkpIHtcbiAgICAgICAgdGhpcy5mZXRjaEFib3J0Q29udHJvbGxlcj8uYWJvcnQoKTtcbiAgICAgICAgdGhpcy5mZXRjaEFib3J0Q29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgICAgICAgdGhpcy5wcmV2aW91c0ljb25TdWJzY3JpcHRpb24/LigpO1xuICAgICAgICB0aGlzLnByZXZpb3VzSWNvblN1YnNjcmlwdGlvbiA9IE10ZUljb25SZWdpc3RyeVNlcnZpY2UuZ2V0SWNvbihcbiAgICAgICAgICB0aGlzLm5hbWUsXG4gICAgICAgICAgdGhpcy5saWJyYXJ5LFxuICAgICAgICAgIHRoaXMuZmV0Y2hBYm9ydENvbnRyb2xsZXIuc2lnbmFsXG4gICAgICAgICkuc3Vic2NyaWJlKChpY29uLCB1bnN1YikgPT4ge1xuICAgICAgICAgIGlmIChpY29uKSB7XG4gICAgICAgICAgICBjb25zdCBvbGRTdmcgPSB0aGlzLmljb25Tdmc7XG4gICAgICAgICAgICBjb25zdCBvbGRMb2FkZWQgPSB0aGlzLl9sb2FkZWQ7XG5cbiAgICAgICAgICAgIGlmIChpc1NzcigpKSB7XG4gICAgICAgICAgICAgIHRoaXMuaWNvblN2ZyA9IGljb247XG4gICAgICAgICAgICAgIHRoaXMuX2xvYWRlZCA9IGAke3RoaXMubGlicmFyeX1+JHt0aGlzLm5hbWV9YDtcbiAgICAgICAgICAgICAgdGhpcy5yZXF1ZXN0VXBkYXRlKCdpY29uU3ZnJywgb2xkU3ZnKTtcbiAgICAgICAgICAgICAgdGhpcy5yZXF1ZXN0VXBkYXRlKCdfbG9hZGVkJywgb2xkTG9hZGVkKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXMudXBkYXRlQ29tcGxldGUudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5pY29uU3ZnID0gaWNvbjtcbiAgICAgICAgICAgICAgICB0aGlzLl9sb2FkZWQgPSBgJHt0aGlzLmxpYnJhcnl9fiR7dGhpcy5uYW1lfWA7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXF1ZXN0VXBkYXRlKCdpY29uU3ZnJywgb2xkU3ZnKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlcXVlc3RVcGRhdGUoJ19sb2FkZWQnLCBvbGRMb2FkZWQpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gSWYgdGhlIHJlc3VsdCB3YXMgbm90IG51bGwgb3IgdGhlIGZhbGxiYWNrIGljb24gdGhlbiB3ZSBsZWF2ZSB0aGlzIHN1YnNjcmlwdGlvblxuICAgICAgICAgICAgLy8gb3BlbiBpbiBjYXNlIGl0IGxvYWRzIGxhdGVyIG9yIGxhenkgbG9hZGluZyBpcyByZS1lbmFibGVkLlxuICAgICAgICAgICAgaWYgKHRoaXMuaWNvblN2ZyAhPT0gbnVsbCAmJiB0aGlzLmljb25TdmcgIT09IE10ZUljb25SZWdpc3RyeVNlcnZpY2VbJ2ZhbGxiYWNrSWNvbiddKSB7XG4gICAgICAgICAgICAgIHVuc3ViKCk7XG4gICAgICAgICAgICAgIHRoaXMucHJldmlvdXNJY29uU3Vic2NyaXB0aW9uPy4oKTtcbiAgICAgICAgICAgICAgdGhpcy5wcmV2aW91c0ljb25TdWJzY3JpcHRpb24gPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBEdXJpbmcgU1NSIGFsd2F5cyB1bnN1YlxuICAgICAgICAgIGlmIChpc1NzcigpKSB7XG4gICAgICAgICAgICB1bnN1YigpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKCF0aGlzLmljb25TdmcpIHtcbiAgICAgICAgLy8gSWYgdGhlIGljb24gZG9lc24ndCBuZWVkIGFuIHVwZGF0ZSBidXQgd2UgZG9uJ3Qga25vdyB3aGF0IHRoZSBpY29uU3ZnIGlzIChoeWRyYXRpbmcgZnJvbSBTU1IpLCBnZXQgaXQgZnJvbSB0aGUgRE9NXG4gICAgICAgIGNvbnN0IHN2ZyA9IHRoaXMucmVuZGVyUm9vdD8ucXVlcnlTZWxlY3Rvcignc3ZnJyk/Lm91dGVySFRNTCA/PyBudWxsO1xuICAgICAgICAvLyBXYWl0IGZvciB1cGRhdGUgdG8gY29tcGxldGUgdG8gcHJldmVudCBoeWRyYXRpb24gbWlzbWF0Y2hcbiAgICAgICAgdGhpcy51cGRhdGVDb21wbGV0ZS50aGVuKCgpID0+IHtcbiAgICAgICAgICB0aGlzLmljb25TdmcgPSBzdmc7XG4gICAgICAgICAgdGhpcy5yZXF1ZXN0VXBkYXRlKCdpY29uU3ZnJywgbnVsbCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9sb2FkZWQgPSBudWxsO1xuICAgICAgdGhpcy5pY29uU3ZnID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfVxuXG4gIEBvblVwZGF0ZShbJ2FyaWFMYWJlbCddLCB7IG9uOiAnYm90aCcgfSlcbiAgcHJpdmF0ZSBoYW5kbGVBcmlhTGFiZWxDaGFuZ2UoKSB7XG4gICAgaWYgKCF0aGlzLmFyaWFMYWJlbCkge1xuICAgICAgdGhpcy5hcmlhSGlkZGVuID0gJ3RydWUnO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmFyaWFMYWJlbCAmJiB0aGlzLmFyaWFIaWRkZW4gPT09ICd0cnVlJykge1xuICAgICAgdGhpcy5hcmlhSGlkZGVuID0gbnVsbDtcbiAgICB9XG4gIH1cblxuICBwcm90ZWN0ZWQgdXBkYXRlSW5zdGFuY2VTdHlsZXMoY2hhbmdlZFByb3BzKSB7XG4gICAgc3VwZXIudXBkYXRlSW5zdGFuY2VTdHlsZXMoY2hhbmdlZFByb3BzKTtcblxuICAgIGlmIChjaGFuZ2VkUHJvcHMuaGFzKCdzaXplJykgfHwgY2hhbmdlZFByb3BzLmhhcygnaWNvblN2ZycpIHx8IGNoYW5nZWRQcm9wcy5oYXMoJ2F1dG9zaXplJykpIHtcbiAgICAgIGlmICh0aGlzLmF1dG9zaXplIHx8IHRoaXMuc2l6ZSkge1xuICAgICAgICBjb25zdCBzaXplID0gdGhpcy5hdXRvc2l6ZSA/ICdjYWxjKDFlbSArIDJweCknIDogYCR7dGhpcy5zaXplfXB4YDtcbiAgICAgICAgLy8gU3BlY2lmaWNpdHkgaXMgb25lIGxlc3MgdGhhdCBzZS9zcCBwcm9wcyBzbyB0aG9zZSBzdGlsbCBvdmVycmlkZSBkZWZhdWx0IHNpemUgY2FsY3VsYXRpb25zXG4gICAgICAgIHRoaXMuc2V0SW5zdGFuY2VTdHlsZSgnbXRlLWljb24tc2l6aW5nJywgc2VsZWN0b3JGYWN0b3J5KCc6aG9zdDpob3N0JyksIHtcbiAgICAgICAgICB3aWR0aDogc2l6ZSxcbiAgICAgICAgICBtaW5XaWR0aDogc2l6ZSxcbiAgICAgICAgICBoZWlnaHQ6IHNpemUsXG4gICAgICAgICAgbWluSGVpZ2h0OiBzaXplLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpOiB2b2lkIHtcbiAgICBzdXBlci5kaXNjb25uZWN0ZWRDYWxsYmFjaygpO1xuXG4gICAgdGhpcy5wcmV2aW91c0ljb25TdWJzY3JpcHRpb24/LigpO1xuICB9XG5cbiAgcHJpdmF0ZSBuZWVkc0ljb25VcGRhdGUoKSB7XG4gICAgcmV0dXJuICF0aGlzLl9sb2FkZWQgfHwgdGhpcy5fbG9hZGVkICE9PSBgJHt0aGlzLmxpYnJhcnl9fiR7dGhpcy5uYW1lfWA7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIGh0bWxgJHt0aGlzLmluc3RhbmNlU3R5bGVzfSR7dW5zYWZlU1ZHKHRoaXMuaWNvblN2Zyl9YDtcbiAgfVxufVxuXG5kZWNsYXJlIGdsb2JhbCB7XG4gIGludGVyZmFjZSBIVE1MRWxlbWVudFRhZ05hbWVNYXAge1xuICAgICdtdGUtaWNvbic6IE10ZUljb247XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBjc3MgfSBmcm9tICdsaXQnO2V4cG9ydCBjb25zdCBzdHlsZXMgPSBjc3NgOmhvc3R7Ym94LXNpemluZzpjb250ZW50LWJveCFpbXBvcnRhbnQ7Y29sb3I6dmFyKC0taWNvbi1jb2xvcixpbmhlcml0KTtkaXNwbGF5OmlubGluZS1ibG9jaztsaW5lLWhlaWdodDowO3dpZHRoOjI0cHh9Omhvc3QoW2F1dG9zaXplXSl7dmVydGljYWwtYWxpZ246bWlkZGxlfTpob3N0KFttdXRlZF0pey0taWNvbi1jb2xvcjp2YXIoLS1tdGUtaW5rLTIpfXN2Z3tkaXNwbGF5OmJsb2NrO2hlaWdodDoxMDAlO3dpZHRoOjEwMCV9Omhvc3QoOm5vdChbd2l0aENvbG9yXSkpIHN2ZyAqe2NvbG9yOmluaGVyaXQ7ZmlsbDpjdXJyZW50Q29sb3IhaW1wb3J0YW50fTpob3N0KFtjb2xvcj1wcmltYXJ5XSk+c3ZnICp7Y29sb3I6cmdiKHZhcigtLW10ZS1zdGF0dXMtcHJpbWFyeS1iYXNlLXJnYikpfTpob3N0KFtjb2xvcj1zZWNvbmRhcnldKT5zdmcgKntjb2xvcjpyZ2IodmFyKC0tbXRlLXN0YXR1cy1zZWNvbmRhcnktYmFzZS1yZ2IpKX06aG9zdChbY29sb3I9dGVydGlhcnldKT5zdmcgKntjb2xvcjpyZ2IodmFyKC0tbXRlLXN0YXR1cy10ZXJ0aWFyeS1iYXNlLXJnYikpfTpob3N0KFtjb2xvcj1zdWNjZXNzXSk+c3ZnICp7Y29sb3I6cmdiKHZhcigtLW10ZS1zdGF0dXMtc3VjY2Vzcy1iYXNlLXJnYikpfTpob3N0KFtjb2xvcj13YXJuaW5nXSk+c3ZnICp7Y29sb3I6cmdiKHZhcigtLW10ZS1zdGF0dXMtd2FybmluZy1iYXNlLXJnYikpfTpob3N0KFtjb2xvcj1kYW5nZXJdKT5zdmcgKntjb2xvcjpyZ2IodmFyKC0tbXRlLXN0YXR1cy1kYW5nZXItYmFzZS1yZ2IpKX1gOyJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7QUFFQSxTQUFxQiwwQkFBMEI7QUFVeEMsSUFBTSwwQkFBTixNQUE4QjtBQUFBLEVBc0JuQyxjQUFjO0FBcEJkO0FBQUEsU0FBUSxlQUFlLG9CQUFJLElBQThCO0FBR3pEO0FBQUEsU0FBUSxtQkFBbUIsb0JBQUksSUFBMEM7QUFHekU7QUFBQSxTQUFRLGVBQWUsb0JBQW9CO0FBRzNDO0FBQUEsU0FBUSxrQkFBa0I7QUFHMUI7QUFBQSxTQUFRLGtCQUFrQjtBQUcxQjtBQUFBLFNBQVEsWUFBWTtBQU1sQixTQUFLLGlCQUFpQixJQUFJLFlBQVksQ0FBQyxhQUFxQjtBQUMxRCxhQUFPLDRDQUE0QyxRQUFRO0FBQUEsSUFDN0QsQ0FBQztBQUNELFNBQUssaUJBQWlCLElBQUksTUFBTSxDQUFDLGFBQXFCO0FBQ3BELGFBQU8sMkNBQTJDLFFBQVE7QUFBQSxJQUM1RCxDQUFDO0FBQ0QsU0FBSyxRQUFRLEVBQUUsS0FBSyxNQUFNO0FBQUEsSUFBQyxDQUFDO0FBQUEsRUFDOUI7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
